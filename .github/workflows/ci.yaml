name: CI
on:
  pull_request:
    branches:
      - '**'
    types:
      - opened
      - synchronize
      - reopened
      - closed
jobs:
  dump:
    name: Dump GitHub context
    runs-on: ubuntu-latest
    env:
      GITHUB_CONTEXT: ${{ toJson(github) }}
    steps:
      - run: |
          echo "$GITHUB_CONTEXT"
      - run: |
          echo "$GITHUB_SHA"
          echo "$GITHUB_REF"
          echo "$GITHUB_REPOSITORY"
      - run: |
          echo "${{ github.event.action }}"
          echo "${{ github.event.pull_request.merged }}"
          echo "${{ github.event.action != 'closed'}} ${{ github.event.pull_request.merged }}"
          echo "${{ github.ref }}"
          echo "${{ github.ref == 'main' }}"
  fail:
    name: Fail test
    runs-on: ubuntu-latest
    steps:
      - run: |
          echo "success"
      - continue-on-error: true
        run: |
          exit 1
      - run: |
          echo "failed after success"

  need-failed-jobs:
    name: Need failed job
    needs:
      - fail
    runs-on: ubuntu-latest
    steps:
      - run: |
          echo "need failed job"
